/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see core.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[6],{359:function(ia,da,h){function ba(e,h,r){h.endsWith("/")||(h+="/");r=r||{};var w=r.disableWebsockets||!1;this.lT=r.singleServerMode||!1;null!=r.customQueryParameters&&Object(n.b)("wvsQueryParameters",r.customQueryParameters);h.endsWith("blackbox/")||(h+="blackbox/");this.Jm=r.uploadData||null;this.Pv=r.uriData||null;this.fM=r.cacheKey||null;this.yD=Object(f.a)(h,null,w);this.Kf=h;this.PD=e;this.kf=null;this.Lh=aa();this.Ml=aa();
this.Wx=!1;this.Xf=this.Yd=this.qe=this.Ue=null;this.sf=[];this.Iy=[];this.cache={};this.timeStamp=0;this.Gf=[];this.Pg=[];this.mE=null;this.ID=!1;this.BH=this.id=null;this.cG=this.cP=fa;this.GA=0;this.lF=!1;this.j6=1;this.Pz={};this.gz=null;this.wr(!0)}function aa(){var e={promise:null,resolve:null,reject:null,state:0,result:null,request:null,jo:function(){return 1===(e.state&1)},h5:function(){return 2===(e.state&2)},Gh:function(){return!e.h5()&&!e.jo()},O4:function(){return 4===(e.state&4)},BS:function(){e.state|=
4}};e.promise=new Promise(function(f,h){e.resolve=function(){if(0===e.state||4===e.state)e.state=1,e.result=arguments[0],f.apply(null,arguments)};e.reject=function(){if(0===e.state||4===e.state)e.state=2,h.apply(null,arguments)}});return e}function fa(){return!1}function ca(e,f,h){if(!(f in ha))return!0;f=ha[f];for(var n=0;n<f.length;n++){var r=e;var w=f[n];var x=h;if(w.name in r){var y="",aa=!1;r=r[w.name];switch(w.type){case "s":y="String";aa=Object(z.isString)(r);break;case "a":y="Array";aa=Object(z.isArray)(r);
break;case "n":y="Number";aa=Object(z.isNumber)(r)&&Object(z.isFinite)(r);break;case "o":y="Object",aa=Object(z.isObject)(r)&&!Object(z.isArray)(r)}aa||x.reject('Expected response field "'+w.name+'" to have type '+y);w=aa}else x.reject('Response missing field "'+w.name+'"'),w=!1;if(!w)return!1}return!0}h.r(da);var z=h(0);h.n(z);var y=h(1);ia=h(36);var f=h(376),e=h(26),x=h(75),r=h(303),w=h(123),n=h(35),ea=h(135),ha={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",type:"s"},
{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}]};ba.prototype=Object(z.extend)(ba.prototype,{q_:function(){var e=this;return new Promise(function(f,h){var n=new XMLHttpRequest;n.open("GET",e.Kf+"ck");n.withCredentials=e.Wn();
n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?f():h())};n.send()})},z$:function(e,f){this.cP=e||fa;this.cG=f||fa},vM:function(){var e=this;this.Ml=aa();this.Lh=aa();return this.yD.aE().then(function(){e.Wx=!1;e.id=null;e.ID=!1;return e.q_()})},mH:function(){this.cP();this.uz();this.Ue&&(this.Ue.Gh()?this.lf(this.Ue.request):this.Ue.jo()&&this.cG(this.Ue.result.url,"pdf")&&(this.Ue=null,this.$R()));this.Xf&&this.Xf.Gh()&&this.lf(this.Xf.request);this.qe&&this.qe.Gh()?
this.lf(this.qe.request):this.Yd&&this.Yd.Gh()&&this.QO(this.Yd.request);var e;for(e=0;e<this.Gf.length;e++)this.Gf[e]&&this.Gf[e]&&(this.Gf[e].Gh()?this.lf(this.Gf[e].request):this.Gf[e].jo()&&this.cG(this.Gf[e].result.url,"image")&&(this.Gf[e]=null,this.DA(e)));for(e=0;e<this.Pg.length;e++)this.Pg[e]&&this.Pg[e]&&this.Pg[e].Gh()&&!this.Pg[e].O4()&&this.lf(this.Pg[e].request);for(e=0;e<this.sf.length;e++)this.sf[e]&&this.sf[e].Gh()&&this.lf(this.sf[e].request)},uz:function(e){var f=this;this.Wx||
(this.timeStamp=Date.now(),this.yD.hI(function(e){f.w6(e)},function(){return null},function(){return null},!0).then(function(){clearInterval(f.xA);f.xA=null},function(h){f.Wx=!1;if(!f.xA){var n=0;f.ID=!0;f.BH=0;f.xA=setInterval(function(){2>n++?f.mH():(clearInterval(f.xA),e&&e.reject(w.a),Object(y.e)("Blackbox connection failed:"+h))},5E3)}}),this.Wx=!0)},Kba:function(){var f=this,h=createPromiseCapability();if(this.Jm){var n=new FormData;n.append("file",this.Jm.fileHandle,this.Jm.fileHandle.name);
var r=this.Jm.loadCallback;var w="upload";var x=this.Jm.extension}else if(this.Pv){n={uri:this.Pv.uri,ufa:this.Pv.shareId};n=Object.keys(n).map(function(e){return e+"="+(n[e]?encodeURIComponent(n[e]):"")}).join("&");var y="application/x-www-form-urlencoded; charset=UTF-8";r=this.Pv.loadCallback;w="url";x=this.Pv.extension}else return Promise.resolve();var z=new XMLHttpRequest,aa=Object(e.i)(f.Kf,"AuxUpload");aa=Object(ea.a)(aa)+"&type="+w+"&ext="+x;z.open("POST",aa);z.withCredentials=this.Wn();y&&
z.setRequestHeader("Content-Type",y);z.addEventListener("load",function(){if(z.readyState===z.DONE&&200===z.status){var e=JSON.parse(z.response);f.PD=e.uri;r(e);h.resolve(e)}});z.addEventListener("error",function(){h.reject(z.statusText+" "+JSON.stringify(z))});this.Jm&&null!=this.Jm.onProgress&&(z.upload.onprogress=function(e){f.Jm.onProgress(e)});z.send(n);return h.promise},Q$:function(e){this.gz=e},N3:function(e){this.password&&this.Lh.jo()?e(this.password):this.gz(e)},l9:function(e){this.password=
e||null;this.Lh.jo()||(this.uz(this.Lh),this.lf({t:"pages"}));return this.Lh.promise},hv:function(e){this.mE=e||null;this.Lh.jo()||(this.uz(this.Lh),this.lf({t:"pages"}));return this.Lh.promise},xM:function(e){e=Object.assign(e,{uri:encodeURIComponent(this.PD)});this.mE&&(e.ext=this.mE);this.kf&&(e.c=this.kf);this.password&&(e.pswd=this.password);this.fM&&(e.cacheKey=this.fM);return e},lf:function(e){e=this.xM(e);this.yD.send(e)},Yj:function(e){return e},w6:function(e){var f=this,h=e.data,r=e.err,
w=e.t;if(r&&f.gz&&"This document could not be decrypted with the given password"===r)f.gz(function(e){f.l9(e)});else switch(w){case "upload":r?f.Lba.reject(r):f.Lba.resolve("Success");break;case "pages":r?f.Lh.reject(r):ca(h,w,f.Lh)&&f.Lh.resolve(h);break;case "config":r?f.Ml.reject(r):ca(h,w,f.Ml)&&(h.id&&(f.id=h.id),h.auth&&(e=Object(n.a)("wvsQueryParameters"),e.auth=h.auth,Object(n.b)("wvsQueryParameters",e)),h.serverVersion&&(f.dca=h.serverVersion,Object(y.f)("[WebViewer Server] server version: "+
f.dca)),h.serverID?(f.GA=h.serverID===f.BH&&f.lF?f.GA+1:0,f.BH=h.serverID):f.GA=0,f.lF=!1,f.Ml.resolve(h));break;case "health":r?f.Ml.reject(r):ca(h,w,f.Ml)&&(h=h.unhealthy,f.lT&&h?Object(y.h)("Server failed health check. Single server mode ignoring check."):!f.Sda&&h&&1>=f.GA&&(f.lF=!0,f.vM().then(function(){f.mH()},function(){f.mH()})));break;case "pdf":h.url=Object(ea.a)(f.Kf+"../"+encodeURI(h.url));r?f.Ue.reject(r):ca(h,w,f.Ue)&&f.Ue.resolve(h);break;case "docmod":h.url=Object(ea.a)(f.Kf+"../"+
encodeURI(h.url));r?f.Pz[h.rID].reject(r):ca(h,w,f.Ue)&&f.Pz[h.rID].resolve(h);break;case "xod":if(r)this.qe&&this.qe.Gh()&&this.qe.reject(r),this.Yd&&this.Yd.Gh()&&this.Yd.reject(r);else if(h.notFound)h.noCreate||this.qe&&this.qe.Gh()&&this.qe.resolve(h),this.Yd&&this.Yd.Gh()&&this.Yd.resolve(h);else{h.url&&(h.url=Object(ea.a)(f.Kf+"../"+encodeURI(h.url)));if(!this.Yd||this.Yd.jo())this.Yd=aa(),this.Yd.request={t:"xod",noCreate:!0};this.qe||(this.qe=aa(),this.qe.request={t:"xod"});this.Yd.resolve(h);
this.qe.resolve(h)}break;case "annots":if(r)f.Xf.reject(r);else if(ca(h,w,f.Xf)){f.Xf.BS();var z=new XMLHttpRequest;e=f.Kf+"../"+encodeURI(h.url);var ba=h.hasAppearance?Object(ea.a)(e+".xodapp"):null;z.open("GET",Object(ea.a)(e));z.responseType="text";z.withCredentials=this.Wn();z.addEventListener("load",function(){z.readyState===z.DONE&&200===z.status&&f.Xf.resolve({EI:z.response,SL:ba})});z.addEventListener("error",function(){f.Xf.reject(z.statusText+" "+JSON.stringify(z))});z.send()}break;case "image":var da=
this.Gf[h.p];r?da.promise.reject(r):ca(h,w,da)&&(da.result=h,da.result.url=Object(ea.a)(f.Kf+"../"+encodeURI(da.result.url)),da.resolve(da.result));break;case "tiles":da=h.rID;e=this.sf[da];this.sf[da]=null;this.Iy.push(da);if(r)e.reject(r);else if(ca(h,w,e)){for(r=0;r<h.tiles.length;r++)h.tiles[r]=Object(ea.a)(f.Kf+"../"+encodeURI(h.tiles[r]));e.resolve(h)}break;case "text":da=this.Pg[h.p];if(r)da.reject(r);else if(ca(h,w,da)){da.BS();var fa=new XMLHttpRequest;h=Object(ea.a)(f.Kf+"../"+encodeURI(h.url));
fa.open("GET",h);fa.withCredentials=this.Wn();fa.addEventListener("load",function(){fa.readyState===fa.DONE&&200===fa.status&&(da.result=JSON.parse(fa.response),da.resolve(da.result))});fa.addEventListener("error",function(e){da.reject(fa.statusText+" "+JSON.stringify(e))});fa.send()}break;case "progress":"loading"===h.t&&f.trigger(x.a.Events.DOCUMENT_LOADING_PROGRESS,[h.bytes,h.total])}},QN:function(){this.uz(this.Ml);return this.Ml.promise},O1:function(){this.Xf||(this.Xf=aa(),this.Xf.request={t:"annots"},
this.lf(this.Xf.request));return this.Xf.promise},DA:function(e){this.Gf[e]||(this.Gf[e]=aa(),this.Gf[e].request={t:"image",p:e},this.lf(this.Gf[e].request));return this.Gf[e].promise},m9:function(e){this.Pg[e]||(this.Pg[e]=aa(),this.Pg[e].request={t:"text",p:e},this.lf(this.Pg[e].request));return this.Pg[e].promise},n9:function(e,f,h,n){var r=this.sf.length;this.Iy.length&&(r=this.Iy.pop());this.sf[r]=aa();this.sf[r].request={t:"tiles",p:e,z:f,r:h,size:n,rID:r};this.lf(this.sf[r].request);return this.sf[r].promise},
$R:function(){this.Ue||(this.Ue=aa(),this.Ue.request={t:"pdf"},this.ID?this.Ue.resolve({url:this.PD}):this.lf(this.Ue.request));return this.Ue.promise},jO:function(e){var f=this,h=new XMLHttpRequest,n=Object(ea.a)(this.Kf+"aul")+"&id="+this.id,r=new FormData,w={};e.annots&&(w.annots="xfdf");e.watermark&&(w.watermark="png");e.redactions&&(w.redactions="redact");w={t:"docmod",reqID:this.j6++,parts:w};e.print&&(w.print=!0);var x=this.xM(w);r.append("msg",JSON.stringify(x));return Promise.all([e.annots,
e.watermark,e.redactions].map(function(e){return Promise.resolve(e)})).then(function(e){var w=e[0],y=e[1],z=e[2];w&&r.append("annots",w);y&&r.append("watermark",e.watermark);z&&r.append("redactions",z);f.Pz[x.reqID]=aa();h.open("POST",n);h.withCredentials=f.Wn;e=new Promise(function(e,f){h.onreadystatechange=function(){4===h.readyState&&(200===h.status?e():f("An error occurred while sending down annotation data to the server"))}});h.send(r);return e.then(function(){return f.Pz[x.reqID].promise})})},
QO:function(){this.Yd||(this.Yd=aa(),this.Yd.request={t:"xod",noCreate:!0},this.lf(this.Yd.request));return this.Yd.promise},o9:function(){this.qe||(this.qe=aa(),this.qe.request={t:"xod"},this.lf(this.qe.request));return this.qe.promise},vm:function(){return!0},request:function(){},uR:function(){},abort:function(){for(var e=0;e<this.sf.length;e++)this.sf[e]&&(this.sf[e].resolve(null),this.sf[e]=null,this.Iy.push(e));this.close()},QA:function(e){this.kf=this.kf||{};this.kf.headers=e},nea:function(){return this.kf?
Object(z.omit)(this.kf.headers,["Cookie","cookie"]):null},wr:function(e){this.kf=this.kf||{};this.kf.internal=this.kf.internal||{};this.kf.internal.withCredentials=e},Wn:function(){return this.kf&&this.kf.internal?this.kf.internal.withCredentials:null},getFileData:function(){return Promise.reject()}});Object(ia.b)(ba);Object(r.a)(ba);Object(r.b)(ba);da["default"]=ba},376:function(ia,da,h){function ba(h,f,e){function x(e,f){function h(e){r().then(function(f){da&&!ia?setTimeout(function(){h(e)},1):
f.send(JSON.stringify(e))})}function n(e,f,n,r){var ea=window.createPromiseCapability(),ha=!1,ja=ea;y=e;aa=f;ba=n;x=null;r&&(e=Object(ca.a)("wvsQueryParameters"),e.bcid=Object(fa.j)(8),Object(ca.b)("wvsQueryParameters",e));try{e=Ba?za+"/"+Ba:za+"/ws";e=Object(z.a)(e);var ka=new WebSocket(e);ka.onopen=function(){ea.resolve();ha=!0;ea=null;da=!1;w.resolve(ka);aa&&aa()};ka.onerror=function(e){da=ia=!0;ea&&ea.reject(e);x&&x.reject()};ka.onclose=function(){w=window.createPromiseCapability();da=!0;x||(x=
window.createPromiseCapability());x.resolve();ba&&ba();y&&ha&&y({t:"health",data:{unhealthy:!0,isDead:!0}})};ka.onmessage=function(e){e&&e.data&&(e=JSON.parse(e.data),e.hb?h({hb:!0}):e.end?close():y(e))}}catch(Ea){ea.reject(Ea),ea=null}return ja.promise}function r(){da&&y&&n(y);return w.promise}var w=window.createPromiseCapability(),x=null,y,aa,ba=null,da=!1,ia=!1,Ba=f,za=function(e){var f=e.indexOf("://"),h="ws://";0>f?f=0:(5===f&&(h="wss://"),f+=3);var n=e.lastIndexOf("/");0>n&&(n=e.length);return h+
e.slice(f,n)}(e);return{send:h,hI:n,aE:function(){return x?x.promise:r().then(function(e){x=window.createPromiseCapability();y=null;e.close();return x.promise})}}}function r(e){var f=e.lastIndexOf("/");0>f&&(f=e.length);return e.slice(0,f)}return window.WebSocket&&!e?x(h,f):function(e,f){function h(e){(da?da.promise:Promise.resolve(ca)).then(function(f){var h=new XMLHttpRequest,n=ba?y+"/"+ba+"pf":y+"/pf";n=Object(z.a)(n)+"&id="+f;f=new FormData;f.append("data",JSON.stringify(e));h.open("POST",n);
h.withCredentials=!0;h.send(f)})}function n(){ca=0;da||(da=window.createPromiseCapability())}function w(){x=new XMLHttpRequest;var e=y+"/pf";e+=0!==ca?"?id="+ca+"&uc="+za:"?uc="+za;za++;x.open("GET",e,!0);x.withCredentials=!0;x.setRequestHeader("Cache-Control","no-cache");x.setRequestHeader("X-Requested-With","XMLHttpRequest");var f=x,r=!1;x.onreadystatechange=function(){a:if(3<=f.readyState&&!r){try{var e=f.responseText.length}catch(Ca){Object(aa.f)("caught exception");break a}if(0<e)try{var x=f.responseText.split("\n");
for(x[x.length-1]&&x.pop();0<x.length&&3>x[x.length-1].length;)"]"===x.pop()&&n();0<x.length&&3>x[0].length&&x.shift();for(e=0;e<x.length;++e)x[e].endsWith(",")&&(x[e]=x[e].substr(0,x[e].length-1));0===ca&&0<x.length&&(ca=JSON.parse(x.shift()).id,e=da,da=null,e.resolve(ca));var y;for(e=0;e<x.length;++e)(y=JSON.parse(x[e]))&&y.end?close():y&&y.hb&&y.id===ca?h({hb:!0}):Ba(y)}catch(Ca){}fa||(r=!0,w())}};x.send()}var x,y=r(e),ba=f,ca=0,da=window.createPromiseCapability(),fa=!1,ia=null,Ba=null,za=0;return{send:h,
hI:function(e,f,h){Ba=e;ia=h;fa=!1;n();w();f&&f();return Promise.resolve()},aE:function(){n();Ba=null;fa=!0;ia&&ia();x.abort();return Promise.resolve()}}}(h,f)}h.d(da,"a",function(){return ba});var aa=h(1),fa=h(26),ca=h(35),z=h(135)}}]);}).call(this || window)
